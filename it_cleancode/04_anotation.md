## 04. ANOTATION for EXPLAIN

### DAY 7

🔖 오늘 읽은 범위 : 4장 주석

---

😃 **기억하고 싶은 내용**


- *나쁜 코드에 주석을 달지 마라. 새로 짜라.*

	```
	🚫 우리는 코드로 의도를 표현하지 못해, 그러니까 실패를 만회하기 위해 주석을 사용한다. 허나 주석은 항상도 아니고 고의도 아니지만 너무 자주 거짓말을 하곤 한다. 진실은 바로 코드에 존재한다.
	```

- 주석은 나쁜 코드를 보완하지 못한다. 주석을 달아야겠다는 생각이 든다면 리팩터링을 할 시점이라는 뜻이다.
- 코드로 의도를 표현해야 한다. 많은 경우 주석을 함수로 대체할 수 있다.

### 좋은 주석

- **법적인 주석**
    ```java
    // Copyright (C) 2003, 2004, ...
    // GMU General Public License 버전 2 이상을 따르는 조건을 배포.
    ```
    
- **정보를 제공하는 주석**
    ```java
    // 테스트 중인 Responder 인스턴스를 반환한다.
    protected abstract Responder responderInstance();
    
    // kk:mm:ss EEE, MMM dd, yyyy
    pattern timeMatcher = Pattern.compile("\\d*:\\d*:\\d* \\w*, \\w* \\d*, \\d*");
    ```
    1. 첫번째 주석: 함수명을 responderBeingTested로 바꾸면 주석이 필요 없어진다.
    2. 두번째 주석: 시각과 날짜를 변환하는 클래스를 만들어 코드를 옮겨주면 주석이 필요 없어진다.
    3. 결과: 결국 이 쪽도 주석을 사용하지 않는 쪽이 더 낫다.
	
- **의도를 설명하는 주석**: 때때로 주석은 구현을 이해하게 도와주는 선을 넘어 결정에 깔린 의도까지 설명한다.

- **의미를 명료하게 밝히는 주석**: 일반적으로 인수나 반환값 자체를 명확하게 만들면 더 좋겠지만, 인수나 반환값이 표준 라이브러리나 변경하지 못하는 코드에 속한다면 의미를 명료하게 밝히는 주석이 유용하다. 하지만 그릇된 주석을 달아놓을 위험이 상당히 높아서 해당 주석을 달기보다 더 나은 방법이 없는 고민하고 정확히 달도록 각별히 주의해야 한다.

- **결과를 경고하는 주석**
    ```java
    // -- 이전방식. 메소드 이름 앞에 _ 붙이기
    // 여유 시간이 충분하지 않다면 실행하지 마십시오. 
    public void _testWithReallyBigFile() { 
    	// -- 시간이 오래 걸리는 테스트 코드
    }
    
    // -- 요즘방식
    @ignore("실행이 너무 오래 걸린다") 
    public void testWithReallyBigFile() { 
    	// -- 시간이 오래 걸리는 테스트 코드
    }
    ```
    
    ```jsx
    public stati SimpleDateFormat makeStandardHttpDateFormat(){
    	// SimpleDateFormat은 스레드에 안전하지 못하다.
    	// 따라서 각 인스턴스를 독립적으로 생성해야 한다.
    	SimpleDateFormat df = new SimpleDateFormat("EEE, dd MMM yyyy HH:mm:ss z");
    	df.setTimeZone(TimeZone.getTimeZone("GMT"));
    	return df;
    }
    // -- 프로그램 효율을 높이기 위해 정적 초기화 함수를 사용하려던 프로그래머가
    // -- 주석 때문에 실수를 면한다.
    ```
    
- **TODO 주석**: 더 이상 필요 없는 기능을 삭제하라는 알림, 누군가에게 문제를 봐달라는 요청, 더 좋은 이름을 떠올려달라는 부탁, 앞으로 발생할 이벤트에 맞춰 코드를 고치라는 주의 등 다양하게 사용될 수 있지만 결국 남용되면 안된다. 이 주석은 주기적으로 정리해야 한다.

- **중요성을 강조하는 주석**: 자칫 대수롭지 않다고 여겨질 뭔가의 중요성을 강조할 때 사용한다.
    ```java
    String listItemContent = match.group(3).trim();
    // 여기서 trim은 정말 중요하다. trim 함수는 문자열에서 시작 공백을 제거한다.
    // 문자열에 시작 공백이 있으면 다른 문자열로 인식되기 때문이다.
    new ListItemWidget(this, listItemContent, this.level + 1);
    return buildList(text.substring(match.end()));
    ```
    
- **공개 API에서 Javadocs**: 설명이 잘 된 공개 API는 참으로 유용하고 만족스럽다. 공개 API를 구현한다면 반드시 훌륭한 Javadocs를 작성한다. 하지만 다른 주석과 마찬가지로 여러가지 위험성이 존재한다는 것을 잊지 말아야 한다.

### 나쁜 주석(대다수의 주석. 코드를 오염시키므로 발견하자마자 삭제할 것)

- **주절거리는 주석**: 이왕 주석을 달아놓기로 했으면 충분한 시간을 들여 최고의 주석을 달도록 노력해야 한다. 이해가 안되어 다른 모든 모듈까지 뒤져야 하는 주석은 독자와 제대로 소통하지 못하는 주석이다.

- **같은 이야기를 중복하는 주석**: 코드 내용을 그대로 설명하는 주석이나 Javadocs 등이 여기에 속한다.

- **오해할 여지가 있는 주석**
    ```java
    // this.closed가 true일 때 반환되는 유틸리티 메서드이다.
    // 타임아웃에 도달하면 예외를 던진다.
    public synchronized void waitForClose(final long timeoutMillis) throws Exception{
    	if(!closed){
    		wait(timeoutMillis);
    		if(!closed){
    			throw new Exception("MockResponseSender could not be closed");
    		}
    	}
    }
    ```
    FACT1: this.closed가 true로 변하는 순간에 메서드는 반환되지 않는다.
    FACT2: this.closed가 true여야 메서드는 반환된다.
    FACT3: 아니면 무조건 타임아웃을 기다렸다 this.closed가 그래도 true가 아니면 예외를 던진다.
    
    👉 위의 세가지를 정확히 포함하여 설명하던가 아니면 이미 중복되었으니 차라리 주석을 없애는 편이 더 낫다.
    
- **의무적으로 다는 주석**: 필요 없으면 주석은 달지 말자.

- **이력을 기록하는 주석**: 우리는 소스 코드 관리 시스템이 있다 시리즈1.

- **있으나 마나 한 주석**: 당연히 알 수 있는 것을 적어 놓은 불 필요한 주석은 개발자가 주석을 무시하는 습관에 빠지도록 만든다. 물론 주석으로 장난치지도 말아야겠다. 프로정신 잊지 말 것.

- **무서운 잡음**: 단지 문서를 제공해야한다는 이유 하나만으로 Javadocs를 양산하지 마라.

- **함수나 변수로 표현할 수 있다면 주석을 달지마라**(= 주석이 필요하지 않도록 코드를 개선해라)
    
    ```java
    // 전역 목록 <smodule>에 속하는 모듈이 우리가 속한 하위 시스템에 의존하는가?
    if(smodule.getDependSubsystems().contains(subSysMod.getSubSystem()))
    
    // -- 주석을 없애면 아래와 같다.
    ArrayList moduleDependees = smodule.getDependSubsystems();
    String ourSubSystem = subSysMod.getSubSystem();
    if(moduleDependees.contains(ourSubSystem))
    ```
    
- **위치를 표시하는 주석**: 너무 자주 사용하지 않는다면 배너는 눈에 띄며 주의를 환기한다. 그러므로 반드시 필요할 때만, 아주 드물게 사용하는 편이 좋다. (여기까지 읽어보면 알겠지만 저자의 드물게는 사용하지 말란 말임)

- **닫는 괄호에 다는 주석**: 중첩이 심하고 장황한 함수라면 닫는 괄호가 매우 유용하다. 하지만 이 때 주석을 사용하는 것 대신 함수를 쪼개어 작고 캡슐화된 함수를 만드는 편이 낫다.

- **공로를 돌리거나 저자를 표시하는 주석**: 우리는 소스 코드 관리 시스템이 있다 시리즈2.

- **주석으로 처리한 코드**: 우리는 소스 코드 관리 시스템이 있다 시리즈3.

- **HTML 주석**: 주석은 읽기 쉬워야 한다. 주석에 HTML 태그를 삽입해야 하는 책임은 프로그래머가 아니라 도구가 져야 한다.

- **전역 정보**: 코드 일부에 주석을 달면서 전반적인 정보를 기술하지 마라.
    
    아래 주석은 심하게 중복되었다는 사실 외에도 해당 함수가 통제하지 못하는 기본 포트 정보를 기술해두었다. 어딘가에 있는 포트 기본값을 설정하는 함수가 변하면 해당 주석은 잘못된 정보를 주는 꼴이 되어버린다.
    
    ```java
    /**
     * 적합성 테스트가 동작하는 포트: 기본값은 <b>8082</b>
     *
     * @param fitnessePort
     */
    public void setFitnessePort(int fitnessePort){
    	this.fitnessePort = fitnessePort;
    }
    ```
    
- **너무 많은 정보**: 사용자가 알 필요 없는 정보가 나열된 주석은 지식 자랑용에 불가하다.

- **모호한 관계**
    
    ```java
    /**
     * 모든 픽셀을 담을 만큼 충분한 배열로 시작한다(여기에 필터 바이트를 더한다).
     * 그리고 헤더 정보를 위해 200바이트를 더한다.
     */
    this.getBytes = new byte[((this.width + 1) * this.height * 3) + 200];
    ```
    
    *필터 바이트란? 1을 더한 게 필터 바이트인가 아니면 3을 곱한 게 필터 바이트인가? 아니면 둘 다 필터 바이트에 해당하는가? 헤더 정보를 위해 200을 더하는 이유는?*
    주석을 다는 목적은 코드만으로 설명이 부족해서인데 주석 자체가 설명을 요구하고 있다.
    
- **함수 헤더**: 짧은 함수는 전혀 필요가 없다.

- **비공개 코드에서 Javadocs**: 비공개 코드에 Javadocs를 작성하는 이유가?


🤔 **오늘의 파트에 대한 소감**


- 아는 선배님께 이전부터 주석의 사용에 대한 주의를 받았다. 그 때에는 뭐가 뭔지 몰라서 무조건 주석의 사용을 나쁜 것으로만 정의했던 것 같다. 하지만 이번 챕터에서 명확히 대체 뭐가 나쁜 부분인 것 인지에 대하여 알게 되어 개인적으로 도움이 많이 되었던 것 같다.

- 처음 코딩을 배우기 위해 학원에 다닐 때 선생님께서 닫는 괄호 주석을 반드시 달아 달라고 교육 받았었다. 솔직히 그 때 전부 초보자들 뿐이었기 때문에 코드의 품질을 높이는 것보다 주석을 열심히 달아서 그 끔찍하게 길고 복잡한 코드 made by newbi 를 해독하는데 도움을 받는 것이 최선의 선택이었던 것 같다. 지금에 와서는 적어도 선생님이 ‘물론 이렇게 주석을 사용하는 것보다 함수를 단일책임 단위로 쪼개주는 것이 낫다’라고 한 마디만 설명해주셨으면 하는 안타까움이 남는다. (사실 설명했는데 그 당시 이해 못해서 기억에 남지 않은 걸 수도 있음)


🔎 **추가로 알게 된 것**


---

🤟소감 3줄 요약 

- 주석으로 나쁜 코드를 변명하려고 하지 마라.
- 주석은 함수로 대체할 수 있다.
- 어떻게든 주석을 사용해야 한다면 적어도 코드가 주지 못하는 새로운 정보를 줘라.
